group_by(month, incident_num) %>%
summarise(mean_incident=mean(incident_num)) %>%
ggplot(aes(month, mean_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents by month",
y = "number of incidents",
x= "month")
incidents <- sharks_new %>%
filter(county!=NA)
group_by(county) %>%
summarize(mean=mean(incident_num, na.rm = T))
incidents <- sharks_new %>%
filter(county!="NA")
group_by(county) %>%
summarize(mean=mean(incident_num, na.rm = T))
incidents <- sharks_new %>%
filter(county!="NA")%>%
group_by(county) %>%
summarize(mean=mean(incident_num, na.rm = T))
incidents <- sharks_new %>%
filter(incident_num!="NA")%>%
group_by(county) %>%
summarize(mean=mean(incident_num, na.rm = T))
incidents <- sharks_new %>%
group_by(county) %>%
summarize(mean=mean(incident_num, na.rm = T))
incidents <- sharks_new %>%
group_by(county) %>%
count(incident_num)
incidents <- sharks_new %>%
group_by(county) %>%
count(incident_num)
incidents
library("tidyverse")
library("janitor")
wolves <- read.csv("data/NPS_wolfmortalitydata.csv", na = c("NULL")) %>% clean_names()
names(wolves)
summary(wolves)
wolves %>%
count(park) # show which parks are represented
wolves %>%
group_by(park) %>%
summarize(n_distinct_pack=n_distinct(pack)) %>% # only count number of distinct packs (no repeats)
arrange(desc(n_distinct_pack)) # arrange in desc order to see largest
wolves %>%
select(park, mort_all) %>%
group_by(park) %>%
summarize(human_mortalities=sum(mort_all, na.rm=T)) %>% # calculate total number of mortalities and remove any NAs
arrange(desc(human_mortalities))
names(wolves)
ynp <- wolves %>%
select(park, biolyr, pack, packcode, packsize_aug, mort_yn, mort_all, mort_lead, mort_nonlead, reprody1, persisty1) %>%
filter(park=="YNP")
ynp
ynp %>%
filter(pack=="druid") %>% # filter for the druid peak pack
group_by(biolyr) %>% # group by each year represeted in the data
summarise(mean_pack_size=mean(packsize_aug, na.rm=T)) # This is the average pack size by year
ynp %>%
filter(pack=="druid") %>% # filter for druid peak pack
summarise(mean_pack_size=mean(packsize_aug, na.rm=T)) # This is the average pack size throughout all of the years
ynp %>%
filter(pack=="druid") %>% # filter for only druid peak pack
group_by(biolyr) %>% # group by each year represented in the data
summarise(max_pack_size=max(packsize_aug, na.rm=T)) %>% # find largest druid pack size
arrange(desc(max_pack_size)) # arrange in desc order to see what year had the largest pack size
ynp %>%
group_by(pack) %>%
summarise(overall_persistence=sum(persisty1, na.rm=T)) %>%
arrange(desc(overall_persistence))
wolves %>%
select(park, biolyr, mort_lead) %>%
group_by(park) %>%
filter(between(biolyr, 2005, 2012)) %>%
summarize(mean_mortlead=mean(mort_lead, na.rm=T)) %>%
arrange(desc(mean_mortlead))
View(wolves)
incidents <- sharks_new %>%
group_by(county) %>%
incidents_total = sum(count(incident_num))
incidents <- sharks_new %>%
group_by(county) %>%
count(incident_num)
incidents
white_sharks %>%
select(sex, total_length_cm) %>%
group_by(sex, na.rm=T) %>%
summarise(total_length = sum(total_length_cm, na.rm=T)) %>%
arrange(desc(total_length))
white_sharks %>%
select(sex, total_length_cm) %>%
group_by(sex) %>%
mutate(total_length = sum(total_length_cm, na.rm=T)) %>%
ggplot(aes(sex, total_length))+
geom_bar()+
labs(title = "Total Length by Sex",
x="sex",
y="total length")
white_sharks %>%
group_by(sex) %>%
mutate(total_length = sum(total_length_cm, na.rm=T)) %>%
ggplot(aes(sex, total_length))+
geom_bar()+
labs(title = "Total Length by Sex",
x="sex",
y="total length")
View(sharks)
incidents <- sharks_new %>%
group_by(county) %>%
summarize(n_distinct_incident = n_distinct(incident_num))
incidents <- sharks_new %>%
group_by(county) %>%
summarize(n_distinct_incident = n_distinct(incident_num))
incidents
incidents %>%
ggplot(aes(county, incidents))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents per county",
y = "number of incidents",
x= "county")
incidents %>%
ggplot(aes(county, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents per county",
y = "number of incidents",
x= "county")
sharks_new %>%
group_by(month) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(month, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents per county",
y = "number of incidents",
x= "month")
sharks_new %>%
group_by(county) %>%
summarize(n_injury_types = n_distinct(injury)) %>%
arrange(desc(n_injury_types)
sharks_new %>%
group_by(county) %>%
summarize(n_injury_types = n_distinct(injury)) %>%
arrange(desc(n_injury_types))
sharks_new %>%
group_by(county, injury) %>%
summarize(n_injury_types = n_distinct(injury)) %>%
arrange(desc(n_injury_types))
injury_type <- sharks_new %>%
group_by(county, injury) %>%
summarize(n_injury_types = n_distinct(injury)) %>%
injury_type %>%
filter(injury == "major") %>%
summarise(total_fatality=sum(n_injury_types)) %>%
arrange(desc(total_fatality))
library("tidyverse")
library("janitor")
library("naniar")
sharks <- read_csv("data/SharkIncidents_1950_2022_220302.csv") %>% clean_names()
glimpse(sharks)
sharks %>% naniar::miss_var_summary()
sharks_new <- sharks %>%
replace_with_na_all(condition = ~.x == "NOT COUNTED")
incidents <- sharks_new %>%
group_by(county) %>%
summarize(n_distinct_incident = n_distinct(incident_num))
#incidents
incidents %>%
ggplot(aes(county, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents per county",
y = "number of incidents",
x= "county")
sharks_new %>%
group_by(month) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(month, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents per county",
y = "number of incidents",
x= "month")
library("tidyverse")
library("janitor")
library("naniar")
sharks <- read_csv("data/SharkIncidents_1950_2022_220302.csv") %>% clean_names()
glimpse(sharks)
sharks %>% naniar::miss_var_summary()
sharks_new <- sharks %>%
replace_with_na_all(condition = ~.x == "NOT COUNTED")
incidents <- sharks_new %>%
group_by(county) %>%
summarize(n_distinct_incident = n_distinct(incident_num))
#incidents
incidents %>%
ggplot(aes(county, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents per county",
y = "number of incidents",
x= "county")
sharks_new %>%
group_by(month) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(month, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents per county",
y = "number of incidents",
x= "month")
library("tidyverse")
library("janitor")
library("naniar")
sharks <- read_csv("data/SharkIncidents_1950_2022_220302.csv") %>% clean_names()
glimpse(sharks)
sharks %>% naniar::miss_var_summary()
sharks_new <- sharks %>%
replace_with_na_all(condition = ~.x == "NOT COUNTED")
incidents <- sharks_new %>%
group_by(county) %>%
summarize(n_distinct_incident = n_distinct(incident_num))
#incidents
incidents %>%
ggplot(aes(county, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents per county",
y = "number of incidents",
x= "county")
sharks_new %>%
group_by(month) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(month, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents per county",
y = "number of incidents",
x= "month")
injury_type <- sharks_new %>%
group_by(county, injury) %>%
summarize(n_injury_types = n_distinct(injury))
injury_type %>%
filter(injury == "major") %>%
summarise(total_fatality=sum(n_injury_types)) %>%
arrange(desc(total_fatality))
injury_type <- sharks_new %>%
group_by(county, injury) %>%
summarize(n_injury_types = n_distinct(injury))
injury_type %>%
group_by(county, injury) %>%
summarize(n_injury_types = n_distinct(injury)) %>%
filter(injury == "major") %>%
summarise(total_fatality=sum(n_injury_types)) %>%
arrange(desc(total_fatality))
injury_type %>%
group_by(county, injury) %>%
summarize(n_injury_types = n_distinct(injury)) %>%
filter(injury == "major") %>%
summarise(total_fatality=sum(n_injury_types)) %>%
arrange(desc(total_fatality))
injury_type %>%
group_by(county, injury) %>%
summarize(n_injury_types = n_distinct(injury))
injury_type %>%
group_by(county, injury) %>%
filter(injury == "minor" | injury == "major") %>%
summarize(n_injury_types = n_distinct(injury))
injury_type %>%
group_by(county, injury) %>%
filter(injury != "minor*") %>%
filter(injury != "major") %>%
summarize(n_injury_types = n_distinct(injury))
sharks_new %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num))
sharks_new %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
arrange(desc(n_distinct_incident))
sharks_new %>%
group_by(mode) %>%
mutate(summarize(n_distinct_incident = n_distinct(incident_num))) %>%
ggplot(aes(x=mode))+
geom_density()+
facet_wrap(~n_distinct_incident)
mode_injury <- sharks_new %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
arrange(desc(n_distinct_incident))
mode_injury %>%
ggplot(aes(x=mode))+
geom_density()+
facet_wrap(~n_distinct_incident)
mode_injury %>%
ggplot(aes(injury, n_distinct_incident))+
geom_boxplot()+
facet_grid(mode~.)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks_new %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
arrange(desc(n_distinct_incident))
sharks_new %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(injury, n_distinct_incident))+
geom_boxplot()+
facet_grid(mode~.)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks_new %>%
select(injury, mode, incient_num) %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(injury, n_distinct_incident))+
geom_boxplot()+
facet_grid(mode~.)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks_new %>%
select(injury, mode, incident_num) %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(injury, n_distinct_incident))+
geom_boxplot()+
facet_grid(mode~.)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks_new %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(x=injury, y=n_distinct_incident))+
geom_boxplot()+
facet_grid(mode~.)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
mode_incident <- sharks_new %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
arrange(desc(n_distinct_incident))
mode_incident <- sharks_new %>%
select(incident_num, injury, mode) %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
arrange(desc(n_distinct_incident))
mode_incident <- sharks_new %>%
select(incident_num, injury, mode) %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
arrange(desc(n_distinct_incident))
mode_incident
mode_incident %>%
ggplot(aes(injury, n_distinct_incident))+
geom_boxplot()+
facet_grid(mode~.)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
View(mode_incident)
mode_incident <- sharks_new %>%
select(incident_num, injury, mode) %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
group_by(injury) %>%
summarize(injury_type = n_distinct(injury)) %>%
arrange(desc(n_distinct_incident))
mode_incident <- sharks_new %>%
select(incident_num, injury, mode) %>%
group_by(mode) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
arrange(desc(n_distinct_incident))
#mode_incident
sharks_new %>%
filter(incident != "NA") %>%
group_by(species) %>%
summarize(total=mean(incident_num)) %>%
arrange(desc(total))
sharks_new %>%
filter(incident_num != "NA") %>%
group_by(species) %>%
summarize(total=mean(incident_num)) %>%
arrange(desc(total))
sharks_new %>%
group_by(species) %>%
summarize(total=mean(incident_num)) %>%
arrange(desc(total))
sharks_new %>%
group_by(species) %>%
summarize(total=mean(incident_num, na.rm = T)) %>%
arrange(desc(total))
species_shark <- sharks_new %>%
group_by(species) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
arrange(desc(n_distinct_incident))
species_shark <- sharks_new %>%
group_by(species) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
arrange(desc(n_distinct_incident))
species_shark
species_shark %>%
filter(species == "White") %>%
ggplot(aes(injury, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents",
y = "number of incidents",
x= "county")
sharks_new %>%
group_by(species) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
filter(species == "White") %>%
ggplot(aes(injury, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents",
y = "number of incidents",
x= "county")
sharks_new %>%
group_by(species) %>%
summarize(n_distinct_incident = n_distinct(incident_num)) %>%
arrange(desc(n_distinct_incident))
sharks_new %>%
group_by(species) %>%
mutate(n_distinct(incident_num)) %>%
filter(species == "White") %>%
ggplot(aes(injury, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents",
y = "number of incidents",
x= "county")
sharks_new %>%
group_by(species) %>%
mutate(n_distinct_incident = n_distinct(incident_num)) %>%
filter(species == "White") %>%
ggplot(aes(injury, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents",
y = "number of incidents",
x= "county")
sharks_new %>%
group_by(species) %>%
mutate(n_distinct_incident = n_distinct(incident_num)) %>%
filter(species == "White") %>%
ggplot(aes(injury, n_distinct_incident))+
geom_col()+
theme(axis.text.x=element_text(angle=50, hjust = 1))+
labs(title="total number of incidents",
y = "number of incidents",
x= "type")
sharks_new %>%
group_by(mode) %>%
mutate(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(injury, n_distinct_incident))+
geom_boxplot()+
facet_grid(mode~.)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks_new %>%
group_by(mode) %>%
mutate(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(injury, n_distinct_incident))+
geom_boxplot()+
facet_wrap(~mode)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks_new %>%
group_by(mode) %>%
mutate(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(injury, n_distinct_incident))+
geom_boxplot()+
facet_grid(~.mode)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks_new %>%
group_by(mode) %>%
mutate(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(injury, n_distinct_incident))+
geom_boxplot()+
facet_grid(.~mode)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks_new %>%
group_by(mode) %>%
mutate(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(injury, n_distinct_incident))+
geom_boxplot()+
scale_x_log10()+
facet_grid(.~mode)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks_new %>%
group_by(mode) %>%
mutate(n_distinct_incident = n_distinct(incident_num)) %>%
ggplot(aes(injury, n_distinct_incident))+
geom_boxplot()+
facet_grid(.~mode)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
white_sharks %>%
select(sex, total_length_cm) %>%
group_by(sex) %>%
summarise(total_length = sum(total_length_cm, na.rm=T)) %>%
arrange(desc(total_length))
sharks_new %>%
select(injury, county, incident_num) %>%
group_by(county) %>%
mutate(n_distinct_incident = n_distinct(incident_num))
sharks_new %>%
select(injury, county, incident_num) %>%
group_by(injury, county) %>%
mutate(n_distinct_incident = n_distinct(incident_num))
white_sharks %>%
group_by(sex) %>%
mutate(total_length = sum(total_length_cm, na.rm=T)) %>%
ggplot(aes(sex, total_length))+
geom_bar()+
labs(title = "Total Length by Sex",
x="sex",
y="total length")
