library("tidyverse")
library("janitor")
library("naniar")
global_sharks <- read_csv("data/global-shark-attack.csv") %>% clean_names()
summary(global_sharks)
miss_var_summary(global_sharks)
global_sharks %>%
count(country) %>%
arrange(desc(n)) %>%
head(n=10)
global_sharks %>%
count(country) %>%
arrange(desc(n)) %>%
head(n=10) %>%
ggplot(aes(x=reorder(country, n), y=n)) +
geom_col(fill = "#0099f9", alpha=0.8)+
labs(title="Total Number of Shark Incidents by Country",
x=NULL,
y="n") +
theme(axis.text.x = element_text(angle = 60, hjust = 1),
plot.title = element_text(size = 14, face="bold"))+
geom_text(aes(label = n), vjust = -0.2, size = 3, color = "black")
global_sharks %>%
separate(date, into= c("year", "month", "day"), sep = "-")
global_sharks %>%
separate(date, into= c("year", "month", "day"), sep = "-") %>%
filter(month != "NA") %>%
group_by(month) %>%
summarise(total=n(), .groups='keep') %>%
ggplot(aes(x=as_factor(month), y=total))+
geom_col(fill = "#0099f9", alpha=0.8)+
labs(title="Number of Shark Incidents by Month",
x="Month",
y="n")+
theme(plot.title = element_text(size = 14, face="bold"))
global_sharks %>%
filter(activity != "NA") %>%
count(activity) %>%
arrange(desc(n))
global_sharks %>%
filter(activity != "NA") %>%
ggplot(aes(x=injury, fill=injury))+
geom_bar(alpha=0.8, position="dodge")+
facet_wrap(~activity)+
labs(title="Injury Type by Activity",
x=NULL,
y="Number of Incidents")+
theme(strip.text = element_text(size=10),
axis.text.x = element_text(size=8, angle = 60, hjust = 1))
global_sharks %>%
separate(date, into= c("year", "month", "day"), sep = "-") %>%
mutate(month=as.factor(month)) %>%
count(month) %>%
filter(month != "NA") %>%
summarise(total=n(), .groups='keep') %>%
ggplot(aes(x=as_factor(month), y=total))+
geom_col(fill = "#0099f9", alpha=0.8)+
labs(title="Number of Shark Incidents by Month",
x="Month",
y="n")+
theme(plot.title = element_text(size = 14, face="bold"))
global_sharks %>%
separate(date, into= c("year", "month", "day"), sep = "-") %>%
mutate(month=as.factor(month)) %>%
count(month) %>%
filter(month != "NA") %>%
ggplot(aes(x=as_factor(month), y=total))+
geom_col(fill = "#0099f9", alpha=0.8)+
labs(title="Number of Shark Incidents by Month",
x="Month",
y="n")+
theme(plot.title = element_text(size = 14, face="bold"))
global_sharks %>%
separate(date, into= c("year", "month", "day"), sep = "-") %>%
mutate(month=as.factor(month)) %>%
count(month) %>%
filter(month != "NA") %>%
ggplot(aes(x=as_factor(month), y=n, fill = month))+
geom_col(fill = "#0099f9", alpha=0.8)+
labs(title="Number of Shark Incidents by Month",
x="Month",
y="n")+
theme(plot.title = element_text(size = 14, face="bold"))
global_sharks %>%
separate(date, into= c("year", "month", "day"), sep = "-") %>%
count(month) %>%
filter(month != "NA") %>%
ggplot(aes(x=as_factor(month), y=n, fill = month))+
geom_col(fill = "#0099f9", alpha=0.8)+
labs(title="Number of Shark Incidents by Month",
x="Month",
y="n")+
theme(plot.title = element_text(size = 14, face="bold"))
global_sharks %>%
filter(activity != "NA") %>%
group_by(activity) %>%
count(activity) %>%
arrange(desc(n)) %>%
head(n=5)
global_sharks %>%
filter(activity != "NA") %>%
group_by(activity) %>%
count(activity) %>%
arrange(desc(n)) %>%
head(n=5) %>%
ggplot(aes(x=activity, y=n, fill=activity))+
geom_bar(alpha=0.8, position="dodge")+
facet_wrap(~activity)+
labs(title="Incidents by Activity",
x=NULL,
y="Number of Incidents")+
theme(strip.text = element_text(size=10),
axis.text.x = element_text(size=8, angle = 60, hjust = 1))
global_sharks %>%
filter(activity != "NA") %>%
group_by(activity) %>%
count(activity) %>%
arrange(desc(n)) %>%
head(n=5) %>%
ggplot(aes(x=activity, y=n, fill=activity))+
geom_bar(alpha=0.8, position="dodge")+
labs(title="Incidents by Activity",
x=NULL,
y="Number of Incidents")+
theme(strip.text = element_text(size=10),
axis.text.x = element_text(size=8, angle = 60, hjust = 1))
global_sharks %>%
filter(activity != "NA") %>%
group_by(activity) %>%
count(activity) %>%
arrange(desc(n)) %>%
head(n=5) %>%
ggplot(aes(x=activity, y=n, fill=activity))+
geom_col(alpha=0.8, position="dodge")+
labs(title="Incidents by Activity",
x=NULL,
y="Number of Incidents")+
theme(strip.text = element_text(size=10),
axis.text.x = element_text(size=8, angle = 60, hjust = 1))
global_sharks %>%
filter(sex != "NA") %>%
group_by(sex) %>%
filter(fatal_y_n == "Y") %>%
count(sex) %>%
ggplot(aes(x=sex, y=n, fill=sex))+
geom_col(alpha=0.8)+
labs(title="Number of fatalities by Sex",
x=NULL,
y="Number of Incidents")
global_sharks %>%
filter(sex != "NA") %>%
filter(fatal_y_n == "Y") %>%
group_by(sex) %>%
count(sex) %>%
ggplot(aes(x=sex, y=n, fill=sex))+
geom_col(alpha=0.8)+
labs(title="Number of fatalities by Sex",
x=NULL,
y="Number of Incidents")
global_sharks %>%
filter(sex != "NA") %>%
filter(sex=="M" | sex=="F") %>%
filter(fatal_y_n == "Y") %>%
group_by(sex) %>%
count(sex) %>%
ggplot(aes(x=sex, y=n, fill=sex))+
geom_col(alpha=0.8)+
labs(title="Number of fatalities by Sex",
x=NULL,
y="Number of Incidents")
global_sharks %>%
filter(sex != "NA") %>%
filter(sex=="M" | sex=="F") %>%
filter(fatal_y_n == "Y") %>%
group_by(sex) %>%
count(sex) %>%
ggplot(aes(x=sex, y=n, fill=sex))+
geom_col(alpha=0.8)+
labs(title="Number of Fatalities by Sex",
x=NULL,
y="Number of Incidents")
global_sharks %>%
filter(sex != "NA") %>%
filter(sex=="M" | sex=="F") %>%
mutate(age=as.factor(age)) %>%
filter(age !="NA") %>%
ggplot(aes(x=sex, y=age, fill=sex))+
geom_boxplot(alpha=0.8)+
labs(title="Range of Age for Individuals Attacked by Sex",
x="Age",
y="Number of Incidents")
global_sharks %>%
filter(sex=="M" | sex=="F") %>%
mutate(age=as.factor(age)) %>%
filter(age !="NA") %>%
ggplot(aes(x=sex, y=age, fill=sex))+
geom_boxplot(alpha=0.8)+
labs(title="Range of Age for Individuals Attacked by Sex",
x="Age",
y="Number of Incidents")
View(global_sharks)
global_sharks %>%
filter(sex=="M" | sex=="F") %>%
mutate(age=as.factor(age)) %>%
filter(age !="NA") %>%
ggplot(aes(x=sex, y=age, fill=sex))+
geom_boxplot(alpha=0.8, color="blue")+
labs(title="Range of Age for Individuals Attacked by Sex",
x="Age")
global_sharks %>%
filter(sex=="M" | sex=="F") %>%
mutate(age=as.integer(age)) %>%
filter(age !="NA") %>%
ggplot(aes(x=sex, y=age, fill=sex))+
geom_boxplot(alpha=0.8, color="blue")+
labs(title="Range of Age for Individuals Attacked by Sex",
x="Age")
global_sharks %>%
filter(sex=="M" | sex=="F") %>%
mutate(age=as.integer(age)) %>%
filter(age !="NA") %>%
ggplot(aes(x=sex, y=age, fill=sex))+
geom_boxplot(alpha=0.8, color="pink")+
labs(title="Range of Age for Individuals Attacked by Sex",
x="Age")
global_sharks %>%
filter(year>=1950) %>%
mutate(year=as.factor(year)) %>%
filter(country=="USA") %>%
group_by(area)%>%
count(area)%>%
arrange(desc(n)) %>%
head(n=5)
global_sharks %>%
filter(year>=1950) %>%
mutate(year=as.factor(year)) %>%
filter(country=="USA") %>%
group_by(area)%>%
count(area)%>%
arrange(desc(n)) %>%
head(n=5) %>%
ggplot(aes(x=area, y=n, fill=area))+
geom_col(alpha=0.8)+
labs(title="Top 5 states where shark attacks have been recorded since 1950",
x=NULL,
y="Number of Incidents")
whites <- global_sharks %>%
filter(str_detect(species, pattern = ("White")))
whites %>%
group_by(country) %>%
count(country) %>%
arrange(desc(n))
whites %>%
group_by(country) %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
count(country) %>%
arrange(desc(n)) %>%
head(n=5) %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(alpha=0.8)+
facet_wrap(~country)+
labs(title="Number of Fatal and Non-Fatal Attacks for the Top 5 Countries with Great White Shark Attacks",
x= "Fatal or Non-Fatal",
y= "Number of Incidents")
whites %>%
filter(country=="USA" | country == "AUSTRALIA" | country == "SOUTH AFRICA" | country == "NEW ZEALAND" | country == "ITALY") %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(alpha=0.8)+
facet_wrap(~country)+
labs(title="Number of Fatal and Non-Fatal Attacks for the Top 5 Countries with Great White Shark Attacks",
x= "Fatal or Non-Fatal",
y= "Number of Incidents")
whites %>%
filter(country=="USA" | country == "AUSTRALIA" | country == "SOUTH AFRICA" | country == "NEW ZEALAND" | country == "ITALY") %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(alpha=0.8)+
facet_wrap(~country)+
theme(axis.text.x = element_text(angle=50, hjust=1))+
labs(title="Number of Fatal and Non-Fatal Attacks for the Top 5 Countries with Great White Shark Attacks",
x= "Fatal or Non-Fatal",
y= "Number of Incidents")
florida <- global_sharks %>%
filter(area == "Florida") %>%
group_by(location) %>%
arrange(desc(n))
florida <- global_sharks %>%
filter(area == "Florida") %>%
group_by(location) %>%
arrange(desc())
florida <- global_sharks %>%
filter(area == "Florida") %>%
group_by(location) %>%
count(location) %>%
arrange(desc(n))
View(florida)
florida <- global_sharks %>%
filter(area == "Florida") %>%
group_by(location) %>%
count(location) %>%
arrange(desc(n)) %>%
head(n=5)
florida <- global_sharks %>%
filter(area == "Florida") %>%
group_by(location) %>%
count(location) %>%
arrange(desc(n)) %>%
head(n=5)
florida
florida %>%
ggplot(aes(x=location, y=n, fill=location))+
geom_col(alpha=0.8)+
labs(title="Top 5 Florida Locations with Shark Attacks",
x="Location",
y="Number of Incidents")
florida %>%
ggplot(aes(x=location, y=n, fill=location))+
geom_col(alpha=0.8)+
theme(axis.text.x = element_text(angle=50, hjust=1))+
labs(title="Top 5 Florida Locations with Shark Attacks",
x="Location",
y="Number of Incidents")
